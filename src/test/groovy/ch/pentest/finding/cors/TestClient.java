package ch.pentest.finding.cors;

import io.micronaut.http.HttpResponse;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.annotation.Header;
import io.micronaut.http.client.annotation.Client;

/**
 * @author Osian Hughes (osian.hughes@onstructive.ch)
 */
@Client("/test/cors")
public interface TestClient {

  @Header(name = "Origin", value = "http://localhost")
  @Get
  HttpResponse<String> successfulGet();


  //The following origin should fail because it doesn't match the configuration
  @Header(name = "Origin", value = "http://cors-attack")
  @Get
  HttpResponse<String> failedGet();

}
